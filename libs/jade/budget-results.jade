block settings
	- var title = "Budgeting tool"
	- var sidebar = true
	- var toolbars = true
	//- var cookiemonster = true
	- var mockup = true

extends ../template/template.jade

block breadcrumbs
	+breadcrumbs([
		{title: "Home", href: "index.html"}, 
		{title: "Templates", href: "index.html#templates"},
		{title: "Budgeting tool"}])

block sidebar
	- var section = "Sidebar"
	+sidebar([
		{title: "Link"}
		],0)

block section-notice
	aside.section-notice
		h2.screenreader Notice
		.section-notice__content
			p #[span.badge NEW] This page is part of #[a(href="#") our new approach to digital advice].

block script
	script(type="text/javascript", src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js")
	script(src="../libs/javascript/vendor/highcharts/highcharts.js")
	script(src="../libs/javascript/vendor/highcharts/modules/exporting.js")
	script.
		// PIE CHART
		$(function () {
			var chart = new Highcharts.Chart({
				chart: {
					type: 'pie',
					renderTo: 'mobile-chart',
					backgroundColor:'#f2f2f2'
				},
				title: {
					text: 'Spending'
				},
				tooltip: {
					valuePrefix: '£'
				},
				plotOptions: {
					pie: {
						allowPointSelect: false,
						cursor: 'pointer',
						dataLabels: {
							enabled: true
						},
						showInLegend: false
					}
				},
				credits: {
					enabled: false
				},
				series: [{
					name: 'Spending',
					colorByPoint: true,
					data: [{
						name: 'Bills',
						y: 6
					}, {
						name: 'Household',
						y: 11
					}, {
						name: 'Leisure',
						y: 10
					}, {
						name: 'Travel',
						y: 4
					}, {
						name: 'Car',
						y: 7
					}, {
						name: 'Child',
						y: 7
					}, {
						name: 'Family',
						y: 3
					}, {
						name: 'Debt',
						y: 14
					}, {
						name: 'Savings',
						y: 1
					}]
				}]
			});
		});

		// DESKTOP CHART
		$(function () {

			var colors = Highcharts.getOptions().colors,
				categories = ['Bills', 'Household', 'Leisure', 'Travel', 'Car', 'Child', 'Family', 'Debt', 'Savings'],
				data = [{
					y: 6,
					color: colors[0],
					drilldown: {
						name: 'Bills',
						categories: ['Rent or mortgage', 'Council Tax / Rates', 'Buildings and contents insurance', 'Gas and electricity', 'Water', 'TV licence'],
						data: [1, 1, 1, 1, 1, 1],
						color: colors[0]
					}
				}, {
					y: 11,
					color: colors[1],
					drilldown: {
						name: 'Household',
						categories: ['Grocery shopping (include food, drinks, toiletries and cleaning supplies etc)', 'Work lunches and coffees, teas etc', 'Cigarettes and tobacco', 'Alcohol (bought from an off-licence or shop but not from the pub, bar or restaurant)', 'Clothing and footwear', 'Repairs and house maintenance', 'Hire purchases or conditional sale items (eg a sofa or TV paid in monthly instalments)', 'Haircuts', 'Laundrette', 'Medicines (including prescription charges)', 'Dentistry', 'Insurance (life or home, but not travel)'],
						data: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
						color: colors[1]
					}
				}, {
					y: 10,
					color: colors[2],
					drilldown: {
						name: 'Leisure',
						categories: ['Meals and drinks out', 'Memberships (eg gym or cinema membership)', 'Magazines and newspapers', 'Books or music (in any format)', 'Website subscriptions (eg news, dating or music/video streaming websites)', 'Season tickets', 'Cinema or theatre tickets', 'Holiday (include cost of travel, accommodation, expenses while you’re there and travel insurance) ', 'Cigarettes or other tobacco', 'Lottery and pools'],
						data: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
						color: colors[2]
					}
				}, {
					y: 4,
					color: colors[3],
					drilldown: {
						name: 'Travel',
						categories: ['Public transport (including season tickets', 'Taxis', 'Bicycle (including running costs such as repair or rental', 'Car rental (including petrol'],
						data: [1, 1, 1, 1],
						color: colors[3]
					}
				}, {
					y: 7,
					color: colors[4],
					drilldown: {
						name: 'Car',
						categories: ['Car insurance', 'Road tax', 'Fuel', 'MOT', 'Car maintenance', 'Breakdown or recovery', 'Parking/congestion charges'],
						data: [1, 1, 1, 1, 1, 1, 1],
						color: colors[4]
					}
				}, {
					y: 7,
					color: colors[5],
					drilldown: {
						name: 'Child',
						categories: ['Childcare', 'Child support/maintenance', 'Tuition fees', 'School uniform', 'School meals', 'Pocket money and school trips', 'Nappies and baby items (if you haven’t already included in groceries)'],
						data: [1 ,1 ,1 ,1 ,1 ,1 ,1],
						color: colors[5]
					}
				}, {
					y: 3,
					color: colors[6],
					drilldown: {
						name: 'Family',
						categories: ['Adult care (eg care home costs for an elderly relative)', 'Christmas and birthday presents', 'Pet-related expenses (eg vet bills, pet food and insurance)'],
						data: [1, 1, 1],
						color: colors[6]
					}
				}, {
					y: 14,
					color: colors[7],
					drilldown: {
						name: 'Debt',
						categories: ['Mortgage, rent or any loans secured against your home', 'Council Tax', 'Credit card, store card debts or payday loans', 'Bank or building society loans', 'Personal loans', 'Catalogue, home credit or in-store credit debts', 'Overdrafts' , 'Money borrowed from friends or family', 'Income Tax, National Insurance and VAT', 'Gas and electricity bills', 'Child maintenance', 'TV licence', 'Hire purchase agreements', 'Court fines'],
						data: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
						color: colors[7]
					}
				}, {
					y: 1,
					color: colors[8],
					drilldown: {
						name: 'Savings',
						categories: ['Savings'],
						data: [1],
						color: colors[8]
					}
				}],
				sectionData = [],
				spendingData = [],
				i,
				j,
				dataLen = data.length,
				drillDataLen,
				brightness;

			// Build the data arrays
			for (i = 0; i < dataLen; i += 1) {

				// add browser data
				sectionData.push({
					name: categories[i],
					y: data[i].y,
					color: data[i].color
				});

				// add version data
				drillDataLen = data[i].drilldown.data.length;
				for (j = 0; j < drillDataLen; j += 1) {
					brightness = 0.2 - (j / drillDataLen) / 5;
					spendingData.push({
						name: data[i].drilldown.categories[j],
						y: data[i].drilldown.data[j],
						color: Highcharts.Color(data[i].color).brighten(brightness).get()
					});
				}
			}

			// Create the chart
			var chart = new Highcharts.Chart({
				chart: {
					type: 'pie',
					renderTo: 'desktop-chart',
					backgroundColor:'#f2f2f2'
				},
				title: {
					text: 'Spending'
				},
				plotOptions: {
					pie: {
						shadow: false,
						center: ['50%', '50%'],
						cursor: 'pointer',
						dataLabels: {
							enabled: true
						}
					}
				},
				tooltip: {
					valuePrefix: '£'
				},
				series: [{
					name: 'Spending',
					data: sectionData,
					size: '50%',
					dataLabels: {
						formatter: function () {
							return this.y > 5 ? this.point.name : null;
						},
						color: '#ffffff',
						distance: -30
					}
				}, {
					name: 'Versions',
					data: spendingData,
					size: '80%',
					innerSize: '50%',
					dataLabels: {
						formatter: function () {
							// display only if larger than 1
							return this.y > 10 ? '<b>' + this.point.name + ':</b> £' + this.y : null;
						}
					}
				}]
			});
		});

		$(document).ready(function($) {
			$('.table-collapse--toggle').click(function(){
				$(this).toggleClass("active");
				$(this).next().toggle();
			});
		});
	style.
		.highcharts-button {
			display: none;
		}
				
block content
	.articleContent
		div
			h2 Results

			p 
				| Total monthly income: #[strong incomeTotal]
				br
				| Total spending: #[strong spendingTotal]

			h3 You are spending [OverAmount] more than your income
			h3 You are spending [UnderAmount] less than your income

			ul
				li 
					a.a-pdf-doc Download your full budget sheet to save or print
				li 
					a(href="#detailed") See a detailed breakdown of your income and spending

			.callout--alert
				h3 Your income isn’t covering your costs

				p As your income isn’t covering your living costs:
				ul
					li see if there’s any way you can #[a cut your costs/reduce your spending]
					li see if you can #[a get help towards your living costs]
					li make sure you’re #[a prioritising the right bills] - this means that if getting into debt short-term is unavoidable, you can at least keep paying the most important bills and avoid some of the worst dangers of getting in debt
					li if you’re really struggling with your money and are in lots of debt, you can get help from your #[a(href="https://www.citizensadvice.org.uk/about-us/how-we-provide-advice/advice/search-for-your-local-citizens-advice/") local Citizens Advice]

			.callout--confirmation
				h3 You’ve got some money left each month

				p As you’ve got some money spare each month you could consider:
				ul
					li #[a(href="https://www.citizensadvice.org.uk/debt-and-money/savings/") saving some money]
					li increasing your repayments, if you’re repaying debts

			.callout--alert
				h3 Your living costs 

				p The amounts you put in for the following areas look a bit high. There might be good reasons for this, but it might be worth checking if you can cut your costs in these areas:
				ul
					li Gas and electricity - short para of advice and LINK
					li Phone/TV/broadband - short para of advice and LINK 
					li Food - short para of advice and LINK 
					li Insurance - short para of advice and LINK 

			h3 Dealing with debts

			p If you have debts your budget can be used to help find the right debt solution for your circumstances. The options available to you depend on how much (if any) spare income you have each month. You can see our content on #[a(href="https://www.citizensadvice.org.uk/debt-and-money/help-with-debt/options-for-getting-out-of-debt/checking-your-options-for-getting-out-of-debt/") getting out of debt], or get help from your #[a(href="https://www.citizensadvice.org.uk/about-us/how-we-provide-advice/advice/search-for-your-local-citizens-advice/") local Citizens Advice]. 

			h3 Tips for keeping on top of your budget

			p Keep a spending diary for a month to keep track of exactly what you spend. You could keep receipts and write down everything you spend your money on or use a spending diary app on your mobile phone.
			ul
				li Sign up for text balance alerts from your bank - this can help you keep on top of your bank balance.
				li Sign up for online banking - it can be quicker and easier to check your bank balance.

			p Some local Citizens Advice offices also run free sessions on budgeting and managing your money. They cover things like:
			ul
				li how to reduce your costs
				li how to budget
				li how to set up and use a bank account
				li how to set up standing orders and direct debits 

			p Ask #[a(href="https://www.citizensadvice.org.uk/about-us/how-we-provide-advice/advice/search-for-your-local-citizens-advice/") local Citizens Advice] whether they offer these services.

			h2#detailed Detailed breakdown

			table.budget
				thead
					tr
						th(scope="col", colspan="2") Income
				tbody
					tr
						td Wages
						td.amount £50.00
					tr
						td Lodger(s)
						td.amount £50.00
					tr
						td Pension
						td.amount £50.00
					tr.table-collapse--toggle
						td Child Support
						td.amount £50.00
					tr.table-collapse
						td(colspan="2")
							table.budget
								tbody
									tr
										td Child maintenance or support
										td.amount £0.00
									tr
										td Child Benefit
										td.amount £0.00
									tr
										td Child Tax Credit
										td.amount £0.00
									tr
										td Guardian’s Allowance
										td.amount £0.00
					tr.table-collapse--toggle
						td Benefits
						td.amount £50.00
					tr.table-collapse
						td(colspan="2")
							table.budget
								tbody
									tr
										td Attendance Allowance
										td.amount £0.00
									tr
										td Bereavement Allowance
										td.amount £0.00
									tr
										td Bereavement payment (lump-sum)
										td.amount £0.00
									tr
										td Carer’s Allowance
										td.amount £0.00
									tr
										td Disability Living Allowance
										td.amount £0.00
									tr
										td Employment and Support Allowance
										td.amount £0.00
									tr
										td Housing Benefit
										td.amount £0.00
									tr
										td Incapacity Benefit
										td.amount £0.00
									tr
										td Income Support
										td.amount £0.00
									tr
										td Industrial Injuries Benefit
										td.amount £0.00
									tr
										td Jobseeker’s Allowance
										td.amount £0.00
									tr
										td Maternity Allowance
										td.amount £0.00
									tr
										td Pension Credit
										td.amount £0.00
									tr
										td Personal Independence Payment
										td.amount £0.00
									tr
										td Severe Disablement Allowance
										td.amount £0.00
									tr
										td Universal Credit
										td.amount £0.00
									tr
										td War Widow’s (or Widower’s) Pension
										td.amount £0.00
									tr
										td Widowed Parent’s Allowance
										td.amount £0.00
									tr
										td Widow’s Pension
										td.amount £0.00
									tr
										td Winter Fuel Payment and Christmas Bonus
										td.amount £0.00
									tr
										td Working Tax Credit
										td.amount £0.00
									tr
										td Young Person’s Bridging Allowance
										td.amount £0.00
					tr.total
						td Total
						td.amount £250.00

			table.budget
				thead
					tr
						th(scope="col", colspan="2") Spending
				tbody
					tr
						td Health, eg medicines/treatments
						td.amount £70.50
					tr
						td Savings/investments
						td.amount £60.00
					tr
						td Life insurance
						td.amount £20.00
					tr
						td Health insurance
						td.amount £15.00
					tr.total
						td Total
						td.amount £165.50
			
			.well
				div#desktop-chart.hide-mobile(style="min-width: 310px; margin: 0 auto;")
				div#mobile-chart.show-mobile(style="min-width: 310px; margin: 0 auto;")